# Results

### Load the data

We read `sas7bdat` file downloaded from United States Census Bureau. 

"Adult 1 education, household size, and poverty ratio were imputed using sequential regression imputation methods."

```{r}
library(haven)
library(dplyr)
library(tidyr)
nsch_topical <- read_sas(unz('data/nsch_2022e_topical.sas7bdat.zip',
                             'nsch_2022e_topical.sas7bdat'))
nsch_topical <- nsch_topical[nsch_topical$A1_GRADE_IF != 1, ] # imputed rows
```

### Select & Filter

We select to include relevant columns. For details about the meaning of each column, please refer to `data.qmd`. We only study children between age 6-17, so we filter out the `T1` children.

In the end of preprocessing, we stored the data as a csv file called `nsch.csv` inside the data folder

```{r}
parent_ls <- c("A1_ACTIVE", "A1_AGE", "A1_BORN", "A1_EMPLOYED","A1_GRADE",
               "A1_MARITAL", "A1_MENTHEALTH", "A1_PHYSHEALTH", "FAMILY_R")
experence_ls <- c("ACE1", "ACE10", "ACE11", "ACE12", "ACE3", "ACE4", "ACE5",
                  "ACE6", "ACE7", "ACE8", "ACE9")   
factor_ls <- c("BULLIED_R", "BULLY", "EVALFASD","EVERHOMELESS", "FASD",
               "GENETIC", "GRADES","HHCOUNT","HIGRADE_TVIS",
               "HOPEFUL","HOURSLEEP","K2Q30A","K2Q31A","K2Q32A", "K2Q33A",
               "K2Q34A","K2Q35A","K2Q37A","K2Q38A","K4Q22_R","K4Q23")
nsch_df <- nsch_topical |>
  select(all_of(c("HHID", "FORMTYPE", parent_ls, experence_ls, factor_ls))) |>
  filter(FORMTYPE != "T1")

write.csv(nsch_df[,-2], "data/nsch.csv", row.names = FALSE)
# nsch_df <- read.csv("data/nsch_dropna.csv") # See Chapter 2 for Missing Value Analysis
```

